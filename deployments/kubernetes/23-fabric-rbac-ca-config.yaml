apiVersion: v1
kind: ConfigMap
metadata:
  name: ca-hospital-rbac-config
  namespace: medrex-fabric
  labels:
    app: fabric-ca
    org: hospital
    component: rbac-config
data:
  fabric-ca-server-config.yaml: |
    version: 1.5.0
    port: 7054
    debug: false
    crlsizelimit: 512000
    tls:
      enabled: true
      certfile:
      keyfile:
      clientauth:
        type: noclientcert
        certfiles:
    ca:
      name: ca-hospital
      keyfile:
      certfile:
      chainfile:
    crl:
      expiry: 24h
    registry:
      maxenrollments: -1
      identities:
        - name: admin
          pass: adminpw
          type: client
          affiliation: ""
          attrs:
            hf.Registrar.Roles: "*"
            hf.Registrar.DelegateRoles: "*"
            hf.Revoker: true
            hf.IntermediateCA: true
            hf.GenCRL: true
            hf.Registrar.Attributes: "*"
            hf.AffiliationMgr: true
    db:
      type: sqlite3
      datasource: fabric-ca-server.db
      tls:
        enabled: false
    ldap:
      enabled: false
    affiliations:
      hospital:
        - department.cardiology
        - department.neurology
        - department.oncology
        - department.pediatrics
        - department.emergency
        - department.surgery
        - department.radiology
        - department.pathology
        - department.pharmacy
        - department.administration
        - ward.icu
        - ward.general
        - ward.pediatric
        - ward.maternity
        - ward.emergency
    signing:
      default:
        usage:
          - digital signature
        expiry: 8760h
      profiles:
        ca:
          usage:
            - cert sign
            - crl sign
          expiry: 43800h
          caconstraint:
            isca: true
            maxpathlen: 0
        tls:
          usage:
            - signing
            - key encipherment
            - server auth
            - client auth
            - key agreement
          expiry: 8760h
    csr:
      cn: ca.hospital.medrex.com
      keyrequest:
        algo: ecdsa
        size: 256
      names:
        - C: US
          ST: "California"
          L: "San Francisco"
          O: "Medrex Hospital Organization"
          OU: "Fabric"
      hosts:
        - ca-hospital
        - ca-hospital-service
        - ca-hospital-service.medrex-fabric.svc.cluster.local
        - ca.hospital.medrex.com
        - localhost
    idemix:
      rhpoolsize: 1000
      nonceexpiration: 15s
      noncesweepinterval: 15m
    bccsp:
      default: SW
      sw:
        hash: SHA2
        security: 256
        filekeystore:
          keystore: msp/keystore
    cacount:
    cafiles:
    intermediate:
      parentserver:
        url:
        caname:
      enrollment:
        hosts:
        profile:
        label:
      tls:
        certfiles:
        client:
          certfile:
          keyfile:
    cfg:
      identities:
        passwordattempts: 10
        allowremove: false
      affiliations:
        allowremove: false
    operations:
      listenAddress: 0.0.0.0:17054
      tls:
        enabled: false
    metrics:
      provider: prometheus
      statsd:
        network: udp
        address: 127.0.0.1:8125
        writeInterval: 10s
        prefix: server
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: ca-pharmacy-rbac-config
  namespace: medrex-fabric
  labels:
    app: fabric-ca
    org: pharmacy
    component: rbac-config
data:
  fabric-ca-server-config.yaml: |
    version: 1.5.0
    port: 7054
    debug: false
    crlsizelimit: 512000
    tls:
      enabled: true
      certfile:
      keyfile:
      clientauth:
        type: noclientcert
        certfiles:
    ca:
      name: ca-pharmacy
      keyfile:
      certfile:
      chainfile:
    crl:
      expiry: 24h
    registry:
      maxenrollments: -1
      identities:
        - name: admin
          pass: adminpw
          type: client
          affiliation: ""
          attrs:
            hf.Registrar.Roles: "*"
            hf.Registrar.DelegateRoles: "*"
            hf.Revoker: true
            hf.IntermediateCA: true
            hf.GenCRL: true
            hf.Registrar.Attributes: "*"
            hf.AffiliationMgr: true
    db:
      type: sqlite3
      datasource: fabric-ca-server.db
      tls:
        enabled: false
    ldap:
      enabled: false
    affiliations:
      pharmacy:
        - department.clinical_pharmacy
        - department.retail_pharmacy
        - department.compounding
        - department.inventory
        - department.quality_assurance
    signing:
      default:
        usage:
          - digital signature
        expiry: 8760h
      profiles:
        ca:
          usage:
            - cert sign
            - crl sign
          expiry: 43800h
          caconstraint:
            isca: true
            maxpathlen: 0
        tls:
          usage:
            - signing
            - key encipherment
            - server auth
            - client auth
            - key agreement
          expiry: 8760h
    csr:
      cn: ca.pharmacy.medrex.com
      keyrequest:
        algo: ecdsa
        size: 256
      names:
        - C: US
          ST: "California"
          L: "San Francisco"
          O: "Medrex Pharmacy Organization"
          OU: "Fabric"
      hosts:
        - ca-pharmacy
        - ca-pharmacy-service
        - ca-pharmacy-service.medrex-fabric.svc.cluster.local
        - ca.pharmacy.medrex.com
        - localhost
    idemix:
      rhpoolsize: 1000
      nonceexpiration: 15s
      noncesweepinterval: 15m
    bccsp:
      default: SW
      sw:
        hash: SHA2
        security: 256
        filekeystore:
          keystore: msp/keystore
    cacount:
    cafiles:
    intermediate:
      parentserver:
        url:
        caname:
      enrollment:
        hosts:
        profile:
        label:
      tls:
        certfiles:
        client:
          certfile:
          keyfile:
    cfg:
      identities:
        passwordattempts: 10
        allowremove: false
      affiliations:
        allowremove: false
    operations:
      listenAddress: 0.0.0.0:17054
      tls:
        enabled: false
    metrics:
      provider: prometheus
      statsd:
        network: udp
        address: 127.0.0.1:8125
        writeInterval: 10s
        prefix: server